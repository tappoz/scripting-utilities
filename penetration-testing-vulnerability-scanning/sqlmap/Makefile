# ----------------------------------------------------------------------------------------------------- #
# https://github.com/tappoz/scripting-utilities/tree/master/penetration-testing-vulnerability-scanning/ #
# ----------------------------------------------------------------------------------------------------- #

# https://sqlmap.org/
sqlmap-install:
	pip install sqlmap==1.5.10
	sqlmap --version

# https://github.com/sqlmapproject/sqlmap/wiki/Usage
#
# --header "Authorization: Bearer $(JWT)"
# --random-agent
# --save=$(PWD)/options.ini
# --delay=0.15
sqlmap-run-against-sample-backend-rest-app:
	rm -r $(PWD)/out_analysis && \
		mkdir -p $(PWD)/out_analysis
	rm -r $(PWD)/temp_dir && \
		mkdir -p $(PWD)/temp_dir
	-rm $(PWD)/http_traffic_result.txt
	-rm $(PWD)/results.csv
	time sqlmap \
		--answers="test=Y" \
		--batch \
		-m $(PWD)/../sample-backend-rest-app/urls_to_scan.txt \
		--tamper=space2comment \
		-v 0 \
		--dbms=postgresql \
		--all \
		-t $(PWD)/http_traffic_result.txt \
		--flush-session \
		--fresh-queries \
		--results-file $(PWD)/results.csv \
		--output-dir $(PWD)/out_analysis \
		--tmp-dir $(PWD)/temp_dir \
		--purge \
		--level 1 \
		--risk 3 \
		--dbs
